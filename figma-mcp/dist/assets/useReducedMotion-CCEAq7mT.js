import{u as p,b as J}from"./utils-vendor-CLnxGgY3.js";import{a as f}from"./client-D04NRy9h.js";import{e as h}from"./index-Bvit5jpF.js";import{r as c}from"./react-vendor-KfUPlHYY.js";const b={createJob:async e=>{const{data:s}=await f.post("/jobs",{uploadId:e});return s},getJobStatus:async e=>{const{data:s}=await f.get(`/jobs/${e}`);return s},simulateJob:async e=>{await f.post(`/jobs/${e}/simulate`)}},L=2e3,S=()=>{const{jobId:e,status:s,createJob:r,updateStatus:n,setAgent:u,setProgress:g,addLog:m,failJob:d}=h(),l=p({mutationFn:b.createJob,onSuccess:o=>{r(o.jobId)},onError:o=>{d(o.message)}}),{data:t,error:i}=J({queryKey:["job",e],queryFn:()=>b.getJobStatus(e),enabled:!!e&&s!=="completed"&&s!=="failed",refetchInterval:o=>{const a=o.state.data;return(a==null?void 0:a.status)==="completed"||(a==null?void 0:a.status)==="failed"?!1:L},refetchIntervalInBackground:!0});return c.useEffect(()=>{if(t&&(n(t.status),g(t.progress),t.currentAgent&&u(t.currentAgent),t.logs&&t.logs.length>0)){const o=t.logs[t.logs.length-1];o&&m(o)}},[t,n,g,u,m]),c.useEffect(()=>{i&&d(i.message)},[i,d]),{createJob:l.mutate,isCreating:l.isPending,jobStatus:t,error:i}};function v(){const[e,s]=c.useState(()=>typeof window>"u"?!1:window.matchMedia("(prefers-reduced-motion: reduce)").matches);return c.useEffect(()=>{const r=window.matchMedia("(prefers-reduced-motion: reduce)"),n=u=>{s(u.matches)};return r.addEventListener?(r.addEventListener("change",n),()=>r.removeEventListener("change",n)):(r.addListener(n),()=>r.removeListener(n))},[]),e}export{S as a,v as u};
//# sourceMappingURL=useReducedMotion-CCEAq7mT.js.map
